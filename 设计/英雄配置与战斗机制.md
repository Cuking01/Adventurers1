# 英雄配置与战斗机制





#### 英雄属性表类

​	记录英雄的属性，每个属性都是一个函数对象 **Attribute**。

| 属性名                    | 描述                               |
| ------------------------- | ---------------------------------- |
| 生命上限（HP_lim）        |                                    |
| 法力上限（MP_lim）        |                                    |
| 行动力上限（AP_lim）      |                                    |
| 生命值回复（HP_re）       |                                    |
| 法力值回复（MP_re）       |                                    |
| 敏捷（AP_re）             |                                    |
| 初始法力值（MP_init）     | 战斗开始时的法力值                 |
| 初始行动力（AP_init）     | 战斗开始时的行动力值               |
|                           |                                    |
| 攻击力（ATK）             |                                    |
| 物理抵抗（P_res）         |                                    |
| 魔法抵抗（M_res）         |                                    |
|                           |                                    |
| 暴击率（CRT）             |                                    |
| 暴击伤害（CRT_profit）    |                                    |
| 敏捷收益（exAPre_profit） | 回复行动力时，额外敏捷值所乘的系数 |
|                           |                                    |
| 韧性（Con_re)             | 抵抗控制，减少控制时间             |
|                           |                                    |



#### 技能tag

技能tag是一个结构体，由位域组成



#### 战斗流程

+ 检查双方配置信息，载入信息，完成状态的初始化（包括脚本的初始化）。
+ 循环1000帧，每一帧分别调用双方的战斗脚本，每帧对应0.1秒。

+ 若一方全部阵亡则战斗结束
+ 时间到了之后仍未分出胜负则计平局

#### 伤害

战斗的核心之一。

一次伤害带给目标伤害损失。

一次造成伤害的流程是：

1. 首先判断伤害目标的合法性
2. 伤害构建（确定基本伤害数值，确定伤害各种tag，触发伤害构建扳机）
3. 伤害命中前（触发目标的被命中前扳机，获取目标物抗/魔抗值，触发破甲破魔扳机）
4. 伤害命中后（触发目标的被命中扳机，触发伤害的命中后扳机）

部分扳机拥有中断伤害效果（例如闪避）

