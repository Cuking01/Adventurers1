# Adventures1 架构



## 整体架构

+ 通信模块
+ 数据模块
+ 日志模块
+ 内存模块
+ 多线程模块
+ 脚本模块
+ 战斗模块
+ PVP模块
+ PVE模块
+ 主模块

#### 通信模块

​	通信模块用于游戏各个端之间相互通信，共四个端：QQ端，客户端，机器人端，服务器端。

+ QQ端：即腾讯QQ，玩家直接发送QQ消息来下达游戏指令，QQ端对用户来说，使用方便，互动性强，但操作麻烦，对开发者来说，通信容易，鉴权容易。
+ 客户端：是一个exe（也可能再开发一个手机app），需要用电脑，类似于QQ端，但支持更复杂特殊功能，同时直接与服务器交互。
+ 机器人端：负责采集QQ端的消息和给QQ端反馈，使得QQ端可以间接和服务器端交互。
+ 服务器端：一切数据的总处理端，整个游戏的核心部分。

​	

通信模块有一套专用代码，分为四层封装：socket层，协议层，指令分类层，指令处理层。

+ socket层：对socket进行封装，一方面实现跨平台，另一方面简化后续操作。

  >待定
  >
  >

+ 协议层：负责建立和维护连接，分包，加密，统计接入者的信息等，并把指令信息传给下一层。
  >核心数据结构为协议层通信包
  >
  >协议层通信包包括：时间，源类型，源地址，协议层指令，协议层指令参数（不定长）。
  >
  >
  >
  >
+ 指令分类层：由协议层下发的指令进行分类，鉴权后，交给不同模块去处理。
+ 指令处理层：是通信模块与其他模块耦合的地方，对分类层的指令进行具体的执行。



#### 数据模块

​	数据模块提供对数据的使用，修改，备份主要维护以下几部分的数据：玩家数据，英雄数据，游戏统计数据，日志数据。

​	提供存储，读取，序列化，反序列化，备份，版本维护功能，可能提供加密和校验。

#### 战斗模块

​	数据结构：英雄设计表，玩家配置表，战斗数据表，类C脚本类。

+ 英雄设计表：存储英雄的属性和技能，和玩家无关，是全局统一的配置。

  >设计表分两个部分，一个是属性表，一个是技能配置
  >
  >属性分两种：表属性和隐属性，表属性每个英雄单独配置，隐属性全为默认值，属性表只记录表属性。
  >
  >属性表记录基础值和成长值，基础值是英雄等级为0时的值，成长值是每升一级获得的值。
  >
  >技能配置分为，被动技能，普通攻击，和三个主动技能。
  >
  >具体见战斗机制.md
  >
  >



#### 日志模块

#### 内存模块



#### 主模块

